class Solution:
    def solve(self, A):
        P = [0]
        base = 0
        for i, x in enumerate(A, 1):
            P.append(P[-1] + x)
            base += i * x

        ans = base
        for i, x in enumerate(A):
            for j in range(len(A) + 1):
                ans = max(ans, base + P[i] - P[j] - (i - j) * x)
        return ans


s = Solution()
assert s.solve([5, 1, 2]) == 20
assert s.solve([0, 1, 2]) == 8
assert s.solve([1, 1, 2]) == 9
assert s.solve([63, 82, 81, 5, 6, 90,
                57, 0, 50, 69, 59, 61,
                50, 45, 81, 7, 100, 36,
                62, 67, 97, 55, 3, 15,
                36, 15, 89, 24, 73, 0,
                72, 66, 30, 2, 46, 72,
                16, 1, 74, 86, 99, 89,
                57, 91, 60, 17, 76, 95,
                5, 2, 55, 77, 51, 77, 45,
                12, 37, 7, 38, 33, 88, 2,
                4, 25, 42, 27, 81, 16, 14,
                40, 92, 88, 99, 72, 21, 27,
                74, 65, 45, 23, 53, 32, 64,
                63, 45, 70, 96, 5, 70, 97,
                79, 43, 13, 99, 18, 6, 75,
                11, 75, 80]) == 258329

assert s.solve([74, 51, 45, 56, 54, 34, 92, 17, 42,
                69, 73, 68, 52, 74, 60, 72, 93, 92, 37,
                41, 38, 82, 18, 42, 58, 36, 23, 25, 88,
                89, 64, 56, 93, 41, 38, 65, 88, 42, 33,
                92, 57, 43, 69, 57, 43, 59, 11, 32, 82,
                36, 91, 74, 38, 21, 99, 87, 49, 18, 8,
                3, 13, 54, 15, 36, 75, 37, 67, 29, 11,
                86, 66, 22, 12, 34, 38, 42, 76, 81, 55, 49, 71, 45,
                31, 13, 100, 2, 11, 12, 25, 42, 55, 38, 4, 45, 3, 90,
                87, 8, 74, 48]) == 237915


assert s.solve([7, 7, 9, 9, 5]) == 121
assert s.solve([5, 3, 2, 6, 5]) == 71